-- MySQL Script generated by MySQL Workbench
-- Sun May 10 01:55:57 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema skladista
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema skladista
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `skladista` DEFAULT CHARACTER SET utf8 ;
USE `skladista` ;

-- -----------------------------------------------------
-- Table `skladista`.`proizvodjaci`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`proizvodjaci` ;

CREATE TABLE IF NOT EXISTS `skladista`.`proizvodjaci` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `skladista`.`kategorije`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`kategorije` ;

CREATE TABLE IF NOT EXISTS `skladista`.`kategorije` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(45) NULL,
  `nadkategorija` INT UNSIGNED NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `nadkategorija_fk`
    FOREIGN KEY (`nadkategorija`)
    REFERENCES `skladista`.`kategorije` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `nadkategorija_fk_idx` ON `skladista`.`kategorije` (`id` ASC, `nadkategorija` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`proizvodi`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`proizvodi` ;

CREATE TABLE IF NOT EXISTS `skladista`.`proizvodi` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(45) NULL,
  `proizvodjac` INT UNSIGNED NULL,
  `kategorija` INT UNSIGNED NULL,
  `cijena` DECIMAL NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `proiz_kat_fk`
    FOREIGN KEY (`kategorija`)
    REFERENCES `skladista`.`kategorije` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `proiz_man_fk`
    FOREIGN KEY (`proizvodjac`)
    REFERENCES `skladista`.`proizvodjaci` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `proiz_kat_fk_idx` ON `skladista`.`proizvodi` (`kategorija` ASC) ;

CREATE INDEX `proiz_man_fk_idx` ON `skladista`.`proizvodi` (`proizvodjac` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`dobavljaci`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`dobavljaci` ;

CREATE TABLE IF NOT EXISTS `skladista`.`dobavljaci` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `skladista`.`proizvodi_dobavljaca`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`proizvodi_dobavljaca` ;

CREATE TABLE IF NOT EXISTS `skladista`.`proizvodi_dobavljaca` (
  `proizvod_id` INT UNSIGNED NOT NULL,
  `dobavljac_id` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`proizvod_id`, `dobavljac_id`),
  CONSTRAINT `pd_dobavljac_fk`
    FOREIGN KEY (`dobavljac_id`)
    REFERENCES `skladista`.`dobavljaci` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `pd_proizvod_fk`
    FOREIGN KEY (`proizvod_id`)
    REFERENCES `skladista`.`proizvodi` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `pd_dobacljac_fk_idx` ON `skladista`.`proizvodi_dobavljaca` (`dobavljac_id` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`skladista`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`skladista` ;

CREATE TABLE IF NOT EXISTS `skladista`.`skladista` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(45) NULL,
  `naziv_lokacije` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;



-- -----------------------------------------------------
-- Table `skladista`.`proizvodi_skladista`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`proizvodi_skladista` ;

CREATE TABLE IF NOT EXISTS `skladista`.`proizvodi_skladista` (
  `proizvod_id` INT UNSIGNED NOT NULL,
  `skladiste_id` INT UNSIGNED NOT NULL,
  `kolicina` INT UNSIGNED NULL,
  PRIMARY KEY (`proizvod_id`, `skladiste_id`),
  CONSTRAINT `proiz_sklad_fk`
    FOREIGN KEY (`skladiste_id`)
    REFERENCES `skladista`.`skladista` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `sklad_proiz_fk`
    FOREIGN KEY (`proizvod_id`)
    REFERENCES `skladista`.`proizvodi` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `proiz_sklad_fk_idx` ON `skladista`.`proizvodi_skladista` (`skladiste_id` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`osobe`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`osobe` ;

CREATE TABLE IF NOT EXISTS `skladista`.`osobe` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Ime` VARCHAR(45) NULL,
  `Prezime` VARCHAR(45) NULL,
  `Telefon` VARCHAR(45) NULL,
  `datum_zaposljavanja` DATE NULL,
  `JMBG` VARCHAR(45) NOT NULL,
  `naziv_lokacije` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;

CREATE UNIQUE INDEX `JMBG_UNIQUE` ON `skladista`.`osobe` (`JMBG` ASC) ;



-- -----------------------------------------------------
-- Table `skladista`.`prava_pristupa`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`prava_pristupa` ;

CREATE TABLE IF NOT EXISTS `skladista`.`prava_pristupa` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `skladista`.`korisnicki_racuni`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`korisnicki_racuni` ;

CREATE TABLE IF NOT EXISTS `skladista`.`korisnicki_racuni` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `osoba_id` INT UNSIGNED NULL,
  `pravo_pristupa` INT UNSIGNED NOT NULL,
  `password` VARCHAR(150) NOT NULL,
  `email` VARCHAR(150) NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `racun_pristup_fk`
    FOREIGN KEY (`pravo_pristupa`)
    REFERENCES `skladista`.`prava_pristupa` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `racun_osoba_fk`
    FOREIGN KEY (`osoba_id`)
    REFERENCES `skladista`.`osobe` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE UNIQUE INDEX `EMAIL_UNIQUE` ON `skladista`.`korisnicki_racuni` (`email` ASC) ;

CREATE UNIQUE INDEX `osoba_id_UNIQUE` ON `skladista`.`korisnicki_racuni` (`osoba_id` ASC) ;

CREATE INDEX `racun_pristup_fk_idx` ON `skladista`.`korisnicki_racuni` (`pravo_pristupa` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`stanja_kupovine`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`stanja_kupovine` ;

CREATE TABLE IF NOT EXISTS `skladista`.`stanja_kupovine` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `stanje` VARCHAR(45) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `skladista`.`kupovine`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`kupovine` ;

CREATE TABLE IF NOT EXISTS `skladista`.`kupovine` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `korisnicki_racun` INT UNSIGNED NULL,
  `stanje_id` INT UNSIGNED NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `kupovina_racun_fk`
    FOREIGN KEY (`korisnicki_racun`)
    REFERENCES `skladista`.`korisnicki_racuni` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `kupovina_stanje_fk`
    FOREIGN KEY (`stanje_id`)
    REFERENCES `skladista`.`stanja_kupovine` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `kupovina_racun_fk_idx` ON `skladista`.`kupovine` (`korisnicki_racun` ASC) ;

CREATE INDEX `kupovina_stanje_fk_idx` ON `skladista`.`kupovine` (`stanje_id` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`proizvodi_kupovine`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`proizvodi_kupovine` ;

CREATE TABLE IF NOT EXISTS `skladista`.`proizvodi_kupovine` (
  `proizvod_id` INT UNSIGNED NOT NULL,
  `kupovina_id` INT UNSIGNED NOT NULL,
  `kolicina` INT NULL,
  PRIMARY KEY (`proizvod_id`, `kupovina_id`),
  CONSTRAINT `kup_pro_fk`
    FOREIGN KEY (`proizvod_id`)
    REFERENCES `skladista`.`proizvodi` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `pro_kup_fk`
    FOREIGN KEY (`kupovina_id`)
    REFERENCES `skladista`.`kupovine` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `pro_kup_fk_idx` ON `skladista`.`proizvodi_kupovine` (`kupovina_id` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`narudzbe`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`narudzbe` ;

CREATE TABLE IF NOT EXISTS `skladista`.`narudzbe` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `korisnicki_racun` INT UNSIGNED NOT NULL,
  `skladiste_id` INT UNSIGNED NOT NULL,
  `datum_kreiranja` TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP,
  `datum_isporuke` DATE NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `narudzbe_racun_fk`
    FOREIGN KEY (`korisnicki_racun`)
    REFERENCES `skladista`.`korisnicki_racuni` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `narudzbe_skladiste_fk`
    FOREIGN KEY (`skladiste_id`)
    REFERENCES `skladista`.`skladista` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `narudzbe_racun_idx` ON `skladista`.`narudzbe` (`korisnicki_racun` ASC) ;

CREATE INDEX `narudzbe_skladiste_fk_idx` ON `skladista`.`narudzbe` (`skladiste_id` ASC) ;


-- -----------------------------------------------------
-- Table `skladista`.`artikli_narudzbe`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `skladista`.`artikli_narudzbe` ;

CREATE TABLE IF NOT EXISTS `skladista`.`artikli_narudzbe` (
  `dobavljac_id` INT UNSIGNED NOT NULL,
  `proizvod_id` INT UNSIGNED NOT NULL,
  `narudzba_id` INT UNSIGNED NOT NULL,
  `kolicina` INT NULL,
  PRIMARY KEY (`narudzba_id`, `proizvod_id`, `dobavljac_id`),
  CONSTRAINT `art_pd_fk`
    FOREIGN KEY (`dobavljac_id` , `proizvod_id`)
    REFERENCES `skladista`.`proizvodi_dobavljaca` (`dobavljac_id` , `proizvod_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `art_nar_fk`
    FOREIGN KEY (`narudzba_id`)
    REFERENCES `skladista`.`narudzbe` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `art_pd_fk_idx` ON `skladista`.`artikli_narudzbe` (`dobavljac_id` ASC, `proizvod_id` ASC) ;

CREATE INDEX `art_nar_fk_idx` ON `skladista`.`artikli_narudzbe` (`narudzba_id` ASC) ;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

INSERT INTO prava_pristupa(id, naziv) VALUES (1, "ADMIN");
INSERT INTO prava_pristupa(id, naziv) VALUES (2, "UPOSLENIK");
INSERT INTO prava_pristupa(id, naziv) VALUES (3, "KUPAC");


INSERT INTO osobe(Ime, Prezime, Telefon, datum_zaposljavanja, JMBG, naziv_lokacije)
VALUES ("Admin", "Admin", "(+387)61/123-456", now(), "2101999175009", "Sarajevo, Safvet-bega Basagica 33");

INSERT INTO korisnicki_racuni(osoba_id, pravo_pristupa, password, email)
VALUES (
	1,
	1,
	"$2b$10$bXtk.6HbvmPfNXA5HMeJXeK//J2MjWcBGbioO6bjw.NWO2WQErflm",
	"admin@admin.com"
	);

INSERT INTO stanja_kupovine(stanje) VALUES("kreirana");
INSERT INTO stanja_kupovine(stanje) VALUES("primljena");
INSERT INTO stanja_kupovine(stanje) VALUES("u obradi");
INSERT INTO stanja_kupovine(stanje) VALUES("otpremljena");
INSERT INTO stanja_kupovine(stanje) VALUES("blokirana");
INSERT INTO stanja_kupovine(stanje) VALUES("odbijena");
INSERT INTO stanja_kupovine(stanje) VALUES("obrisana");

INSERT INTO proizvodjaci VALUES(1,"proizvodjac1");
INSERT INTO proizvodjaci VALUES(2,"proizvodjac2");
INSERT INTO proizvodjaci VALUES(3,"proizvodjac3");
INSERT INTO proizvodjaci VALUES(4,"proizvodjac4");
INSERT INTO proizvodjaci VALUES(5,"proizvodjac5");

INSERT INTO kategorije VALUES(1,"kat1",null);
INSERT INTO kategorije VALUES(2,"kat2",null);
INSERT INTO kategorije VALUES(3,"kat3",1);


INSERT INTO proizvodi VALUES(1,"proizvod1",1,2,50);
INSERT INTO proizvodi VALUES(2,"proizvod2",1,1,100);
INSERT INTO proizvodi VALUES(3,"proizvod3",2,3,20);
INSERT INTO proizvodi VALUES(4,"proizvod4",1,1,80);
INSERT INTO proizvodi VALUES(5,"proizvod5",2,1,120);
INSERT INTO proizvodi VALUES(6,"proizvod5",3,2,50);
INSERT INTO proizvodi VALUES(7,"proizvod7",1,1,130);
INSERT INTO proizvodi VALUES(8,"proizvod8",2,3,40);
INSERT INTO proizvodi VALUES(9,"proizvod9",4,1,60);
INSERT INTO proizvodi VALUES(10,"proizvod10",2,3,220);


INSERT INTO skladista VALUES(1,"skladiste1","lokacija1");
INSERT INTO skladista VALUES(2,"skladiste2","lokacija2");
INSERT INTO skladista VALUES(3,"skladiste3","lokacija3");

INSERT INTO osobe VALUES(2,"ime2","prezime2","(+387)61/145-426","2020-06-30",201238123123,"Sarajevo,Mihrivode");
INSERT INTO osobe VALUES(3,"ime3","prezime3","(+387)62/155-426","2020-04-30",201638423123,"Sarajevo,Kovaci");
INSERT INTO osobe VALUES(4,"ime4","prezime4","(+387)62/165-422","2020-02-21",2012381234123,"Sarajevo,Bistrik");
INSERT INTO osobe VALUES(5,"ime5","prezime5","(+387)61/166-412","2020-06-21",1012381234123,"Sarajevo,Pofalici");
INSERT INTO osobe VALUES(6,"Ime6","Prezime6","(+387)62/146-126","2019-07-03",123456789,"Sarajevo");
INSERT INTO osobe VALUES(7,"Ime7","Prezime7","(+387)63/146-126","2019-03-03",12345789,"Sarajevo");
INSERT INTO osobe VALUES(8,"Ime8","Prezime8","(+387)61/156-121","2019-04-03",12346789,"Sarajevo");
INSERT INTO osobe VALUES(9,"Ime9","Prezime9","(+387)61/146-116","2019-05-03",12345679,"Sarajevo");
INSERT INTO osobe VALUES(10,"Ime10","Prezime10","(+387)62/116-126","2019-06-03",12456789,"Sarajevo");


INSERT INTO proizvodi_skladista VALUES(4,1,20);
INSERT INTO proizvodi_skladista VALUES(5,1,2);
INSERT INTO proizvodi_skladista VALUES(6,1,1);
INSERT INTO proizvodi_skladista VALUES(7,2,5);
INSERT INTO proizvodi_skladista VALUES(8,2,40);
INSERT INTO proizvodi_skladista VALUES(9,2,30);
INSERT INTO proizvodi_skladista VALUES(1,3,10);
INSERT INTO proizvodi_skladista VALUES(2,3,15);
INSERT INTO proizvodi_skladista VALUES(3,3,40);


INSERT INTO dobavljaci VALUES(1,"dobavljac1");
INSERT INTO dobavljaci VALUES(2,"dobavljac2");
INSERT INTO dobavljaci VALUES(3,"dobavljac3");
INSERT INTO dobavljaci VALUES(4,"dobavljac4");

INSERT INTO proizvodi_dobavljaca VALUES(3,4);
INSERT INTO proizvodi_dobavljaca VALUES(4,4);
INSERT INTO proizvodi_dobavljaca VALUES(2,3);

INSERT INTO korisnicki_racuni VALUES(2,2,2,"asd","mail@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(3,3,1,"abc","mail2@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(4,4,3,"qwer","mail3@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(5,5,2,"wwww","mail4@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(6,6,3,"asd123","mail6@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(7,7,1,"abc","mail7@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(8,8,2,"qwerr","mail8@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(9,9,2,"wwwww","mail9@hotmail.com");
INSERT INTO korisnicki_racuni VALUES(10,10,2,"wwwww","mail10@hotmail.com");


INSERT INTO kupovine VALUES(1,3,6);
INSERT INTO kupovine VALUES(2,2,2);
INSERT INTO kupovine VALUES(3,1,3);
INSERT INTO kupovine VALUES(4,5,1);
INSERT INTO kupovine VALUES(5,4,4);
INSERT INTO kupovine VALUES(6,6,5);
INSERT INTO kupovine VALUES(7,7,7);


INSERT INTO proizvodi_kupovine VALUES(4,1,5);
INSERT INTO proizvodi_kupovine VALUES(5,2,10);
INSERT INTO proizvodi_kupovine VALUES(6,3,25);
INSERT INTO proizvodi_kupovine VALUES(7,4,15);
INSERT INTO proizvodi_kupovine VALUES(8,5,5);

INSERT INTO narudzbe VALUES(1,1,1,"2020-03-22","2020-04-10");
INSERT INTO narudzbe VALUES(2,2,2,"2019-07-22","2019-09-10");
INSERT INTO narudzbe VALUES(3,3,3,"2020-01-23","2020-03-14");
INSERT INTO narudzbe VALUES(4,4,1,"2020-02-10","2020-04-13");
INSERT INTO narudzbe VALUES(5,5,2,"2020-03-14","2020-04-11");
INSERT INTO narudzbe VALUES(6,6,3,"2020-03-26","2020-04-12");

INSERT INTO artikli_narudzbe VALUES(3,2,1,5);